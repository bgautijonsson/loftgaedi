
<!-- README.md is generated from README.Rmd. Please edit that file -->

# loftgaedi

<!-- badges: start -->
<!-- badges: end -->

The purpose of this package is to make air quality data from
[loftgaedi.is](https://loftgaedi.is) easily accessible to R users. It
does this by providing helper functions -`get_latest()`, `get_dates()`
and `get_stations()`- that interface with the API and transform the
content to tidy tables. In addition to these, datasets containing all
measurements from 2015-01-01 to 2022-12-31 is incudluded as
`loftgaedi_2015` up to `loftgaedi_2022`.

## Installation

You can install the development version of loftgaedi like so:

``` r
install.packages("pak")
pak::pak("bgautijonsson/loftgaedi")
```

## Examples

``` r
library(loftgaedi)
```

### `get_latest()`

This function provides all air quality data that was recorded in the
last 24 hours, updated hourly at approximately 17 minutes past.

``` r
d <- get_latest()

dplyr::glimpse(d)
#> Rows: 1,440
#> Columns: 8
#> $ name         <chr> "Akureyri Strandgata (við Hof)", "Akureyri Strandgata (vi…
#> $ local_id     <chr> "STA-IS0052A", "STA-IS0052A", "STA-IS0052A", "STA-IS0052A…
#> $ unit         <chr> "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg…
#> $ resolution   <chr> "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h…
#> $ verification <chr> "óyfirfarin", "óyfirfarin", "óyfirfarin", "óyfirfarin", "…
#> $ time         <dttm> 2023-07-24 15:00:00, 2023-07-24 14:00:00, 2023-07-24 13:…
#> $ variable     <chr> "NO", "NO", "NO", "NO", "NO", "NO", "NO", "NO", "NO", "NO…
#> $ value        <dbl> 4.87083, 12.72920, 6.15417, 39.77090, 7.04583, 25.26460, …
```

### `get_dates(dates)`

This function fetches data from the provided dates. The `dates` input
must be a vector of dates or coercible to date format.

``` r
my_dates <- seq.Date(from = as.Date("2023-01-01"), to = as.Date("2023-01-11"), by = "days")
d <- get_dates(my_dates)
#> ■■■■■■ 18% | ETA: 5s ■■■■■■■■■ 27% | ETA: 5s ■■■■■■■■■■■■ 36% | ETA: 4s
#> ■■■■■■■■■■■■■■■ 45% | ETA: 4s ■■■■■■■■■■■■■■■■■ 55% | ETA: 3s
#> ■■■■■■■■■■■■■■■■■■■■ 64% | ETA: 2s ■■■■■■■■■■■■■■■■■■■■■■■ 73% | ETA: 2s
#> ■■■■■■■■■■■■■■■■■■■■■■■■■■ 82% | ETA: 1s ■■■■■■■■■■■■■■■■■■■■■■■■■■■■ 91% |
#> ETA: 1s

dplyr::glimpse(d)
#> Rows: 17,496
#> Columns: 8
#> $ name         <chr> "Akureyri Strandgata (við Hof)", "Akureyri Strandgata (vi…
#> $ local_id     <chr> "STA-IS0052A", "STA-IS0052A", "STA-IS0052A", "STA-IS0052A…
#> $ unit         <chr> "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg…
#> $ resolution   <chr> "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h…
#> $ verification <chr> "óyfirfarin", "óyfirfarin", "óyfirfarin", "óyfirfarin", "…
#> $ time         <dttm> 2023-01-01 23:00:00, 2023-01-01 22:00:00, 2023-01-01 21:…
#> $ variable     <chr> "NO", "NO", "NO", "NO", "NO", "NO", "NO", "NO", "NO", "NO…
#> $ value        <dbl> 2.2875000, 2.0458300, 2.2520800, 2.3125000, 2.1145800, 2.…
```

### `get_stations()`

This function provides basic information about all stations *(location,
activity window, altitude etc.)* in the data.

``` r
d <- get_stations()

dplyr::glimpse(d)
#> Rows: 59
#> Columns: 14
#> $ name                   <chr> "Flúðir Heimaland (Suðurland)", "Reykjanes Hólm…
#> $ local_id               <chr> "STA-IS0016A", "STA-IS0038A", "STA-IS0050A", "S…
#> $ municipality           <chr> "Flúðir", "Reykjanesbær", "Húsavík", "Reykjavík…
#> $ activity_begin         <chr> "2010-04-29", "2016-02-04", "2016-12-01", "2001…
#> $ activity_end           <chr> "2010-07-07", "2018-06-05", NA, "2010-12-31", N…
#> $ network_name           <chr> "Environment Agency of Iceland", "Sameinað Síli…
#> $ network_local_id       <chr> "NET-IS002A", "NET-IS008A", "NET-IS012A", "NET-…
#> $ station_classification <chr> "background", "industrial", "industrial", "back…
#> $ area_classification    <chr> "rural", "suburban", "suburban", "suburban", "u…
#> $ altitude               <int> 10, 10, 47, 50, 19, 41, 65, 160, 83, 624, 328, …
#> $ latitude               <chr> "63.599753", "64.013617", "66.054858", "64.1399…
#> $ longitude              <chr> "-19.97900", "-22.575667", "-17.347550", "-21.7…
#> $ mobile                 <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…
#> $ parameters             <chr> "{NO,PM2.5,NO2,PM10,\"NOX as NO2\"}", "{PAH,PM2…
```

### `loftgaedi_data`

``` r
dplyr::glimpse(loftgaedi_2015)
#> Rows: 508,024
#> Columns: 8
#> $ name         <chr> "Grundartangi Gröf", "Reykjavik Husdyragardurinn", "Akure…
#> $ local_id     <chr> "STA-IS0041A", "STA-IS0006A", "STA-IS0042A", "STA-IS0002A…
#> $ unit         <chr> "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg/m3", "µg…
#> $ resolution   <chr> "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h", "1h…
#> $ verification <chr> "yfirfarin", "yfirfarin", "yfirfarin", "yfirfarin", "yfir…
#> $ time         <dttm> 2015-02-03 23:00:00, 2015-02-03 23:00:00, 2015-02-03 23:…
#> $ variable     <chr> "NO", "NO", "H2S", "PM2.5", "NO2", "NO2", "H2S", "NO2", "…
#> $ value        <dbl> 0.07156895, 1.65000000, 0.64166667, 8.49433333, 0.8173333…
```
